#!/bin/sh

#
# qemu boot script
#
# arg $1: path to kernel bzImage
# arg $2: path to rootfs.cpio
# arg $3: optional qemu arguments (for example "-s -S" for debugging)
#

qemu-system-x86_64 \
    -m 512M \
    -kernel $1 \
    -initrd $2 \
    -append "root=/dev/ram rw console=ttyS0 oops=panic panic=1 kaslr selinux=0 security=apparmor quiet" \
    -cpu kvm64,+smep,+smap \
    -monitor /dev/null \
    -smp 4 \
    -nographic -enable-kvm $3
