# CVE-2016-6187 - Linux Kernel Exploit
Kernel Exploit for CVE-2016-6187 (Local Privilege Escalation) (Affected versions: < 4.6.5)

I have developed the exploit against a custom compiled kernel (version 4.6) + buildroot \
(kconfig coming soon) and I might port it to other targets in the future (Ubuntu 16.04 with a manually upgraded kernel maybe).

## Vulnerability Details
The exploited vulnerability is a heap based single nullbyte overflow in one of AppArmor's LSM hooks (setprocattr).
See https://nvd.nist.gov/vuln/detail/CVE-2016-6187

## Exploit Reliability
The reliability has yet to be measured.

## Requirements

### /dev/rfkill
Unprivileged users must be able to at least open ```/dev/rfkill```. Some distros might
not permit that. I have checked Ubuntu and Fedora, both allow unprivileged users to open ```/dev/rfkill```
(although Fedora is using SELinux instead of AppArmor)

## TODO's

- [x] repair ptmx_fops to increase stability
- [ ] repair kmalloc-128 freelist to increase stability
- [ ] repair message queue to increase stability
- [ ] automatically restart exploit when detecting failure
- [ ] add proper writeup
- [ ] publish kconfig, build instructions, ...
- [ ] code refactoring
